# Aeon

_**Моделирование атаки 51%, проводимое государством**_

[https://youtu.be/0kGM1in2mQ4](https://youtu.be/0kGM1in2mQ4)

---

_**Aeon:**_ Спасибо за предоставленную мне возможность выступить. Это просто потрясающая конференция. Я быть хотел присутствовать на ней лично, но правительство требует от меня какую-то странную бумажку, чтобы я смог пересечь воображаемые границы. Так что, к сожалению, я не смог приехать.

Итак, сегодня я буду говорить на тему, которая меня очень интересует на протяжении последних пары лет. Я занимаюсь вопросами, связанными с Bitcoin и криптовалютами уже довольно давно. Но в последние годы я стал уделять гораздо больше внимания моделям угроз и тому, как эти системы могут быть атакованы, самим способам атаки, поскольку лучше всего узнать всё это до того, как это сделает злоумышленник. Это даёт возможность смягчить последствия и защититься от любых атак. Поэтому сегодня мы поговорим именно об этом, и я надеюсь на дальнейшую дискуссию в стиле школы Сократа, то есть с возможностью задать свой вопрос в конце, высказать свои мысли по этому поводу и получить ответы относительно различных моделей угроз.

Таким образом, это будет скорее некий общий обзор механизма доказательства работы в целом, а не конкретно Monero. Тем не менее, мы коснёмся специфики Monero в контексте некоторых аспектов Monero, связанных с противодействия атакам 51%. Итак, начнём.

Прежде всего, в рамках подобных сценариев всегда следует рассматривать государство в качестве злоумышленника. То есть, доказательство работы является экономически рациональным, достаточно мотивирующим механизмом, чтобы частные лица не были заинтересованы в том, чтобы уничтожить сеть. Если вы желаете накопить достаточную мощь, чтобы совершить атаку 51%, вы можете просто присоединиться к сети, а не действовать против неё. Мотив государства сводится к контролю над денежными потоками, экономической деятельностью и информацией. И государства есть экономически обоснованный стимул, связанный с контролем, в то время как у участника свободного рынка такого стимула нет. Контроль экономической деятельности не интересует простых участников такого рынка. Они просто хотят быть его частью. Следовательно, государство всегда должно рассматриваться в качестве злоумышленника.

И сначала немного базовой информации. Что такое атака 51%? Это самое чёткое определение, которое я смог придумать. Это ситуация. Когда злоумышленник контролирует 51% хэшрейта с целью цензурирования или совершения двойных трат и нанесения ущерба работе сети. То есть, абсолютно любой майнер может заполучить 51% хэшрейта. Это очень выгодно с точки зрения майнинга. Но если такой майнер не цензурирует транзакции и не совершает двойных трат, то это ещё не атака. Система работает нормально. Это риск, это централизация хэшрейта, но при отсутствии прямой атаки ничего страшного в этом нет. Так что в данном случае мы говорим конкретно о намерении нанести ущерб сети.

Чего позволяет добиться атака 51%? Это, опять же, двойные траты, то есть отправка одной и той же суммы денег дважды. Я отправляю 50 Monero на биржу, продаю их на бирже, а затем дважды трачу, используя 51% хэшрейта, чтобы, так сказать, реорганизовать блок, в результате чего транзакция не попадёт в блокчейн. В итоге у меня есть 50 Monero, у биржи - нет, но у меня есть то, что я продал или то, что я купил.

Цензурирование транзакций подразумевает отказ от обработки определённых транзакций. Такой сценарий более вероятен в случае с механизмом доказательства работы Bitcoin, блокчейн которого прозрачен. Допустим, государство контролирует 51% хешрейта. В этом случае оно может цензурировать транзакции, исходящие, допустим, из Северной Кореи, и не добавлять в блокчейн блоки, содержащие соответствующий UTXO. Такой блок будет отклоняться и игнорироваться.

И третье - цензурирование майнеров. Если государство обладает 51% хэшрейта, а майнер, принадлежащий меньшинству, создаёт действительный блок, большинство майнеров может проигнорировать этот блок. Следовательно, майнеры, относящиеся к меньшинству, теряют субсидию за блок и вознаграждение за этот блок. То есть, если я создам блок, который не понравится государству, контролирующего них 51% хэшрейта, оно сможет проигнорировать мой блок и просто продолжит строить основную цепочку, поскольку обладает большим объёмом хэшрейта. Так что, по сути, лицо, способное провести атаку 51%, выбирает, кому платить, так как может цензурировать блоки, и игнорировать блоки, которые содержат что-то, что не понравится такому лицу или цензору.

Идентификация атаки 51%. В этом плане можно упомянуть несколько вещей. Уверен, есть и другие, но я перечислю наиболее очевидные лично для меня. Большое количество "осиротевших" блоков. Это блоки, которые признаются действительными, но впоследствии не учитываются как часть цепочки. Это может происходить в сети органически, когда два блока вычисляются, скажем, в двух разных концах света, а затем поверх них добавляется ещё один блок. И тогда первый вычисленный блок игнорируется, а более поздний блок с двумя блоками поверх него, то есть, более длинная цепочка, проходит дальше. Также такая ситуация может возникнуть в результате проведения атаки 51%. Как я уже говорил, майнер или государство, обладающий большим хешрейтом, могут игнорировать блоки, содержащие транзакции, которые им не понравятся. Они могут просто игнорировать любой такой блок, а затем продолжить построение цепочки, поскольку обладают 51% хэшрейта. Эти узлы выполняют большую часть работы. Именно так устроена система.

Отказ от добавления действительных блоков - та же ситуация, что и с осиротевшими блоками. За этим следует глубокая реорганизация блокчейна. Это похоже на двойную трату. Допустим, в вашем блоке было пять или шесть транзакций, а потом внезапно не оказалось и одной. Это означает, что блокчейн был перестроен либо злоумышленником, либо просто произошло его разветвление.

Теперь о смягчении последствий. Вот тут всё становится по-настоящему интересно. Значительное потребление энергии. Майнинг с использованием механизма доказательства работы действительно требует затраты энергии. Если для защиты блокчейна имеется всего один майнер, использующий один компьютер, это слабая защита. Затраты энергии минимальны. Поэтому значительное использование энергии является одной из важнейших вещей.

Второй по важности является высокая степень распределения майнеров или энергии. В этом отношении стоит отметить, что в случае с Bitcoin в США, Канаде и Европе появились гигантские центры обработки данных с мега-майнерами. Они представляют собой огромный риск для безопасности, потому что их легко идентифицировать. Как правило, они официально зарегистрированы. В будущем, возможно, они будут получать лицензии. Их уже пытаются обложить их налогом - это не сложно. Так что, наличие огромных центров обработки данных с майнерами отнюдь не способствует безопасности сети.

Доступное оборудование для майнинга. Что касается ASIC, мне понятны аргументы в пользу ASIC, и чем хороши эти схемы. И я также понимаю их недостатки. ASIC не так просты в использовании. Для их использования требуется 240 вольт. Домашнего напряжения для них недостаточно. Они производят много шума. Поэтому их используют для майнинга в промышленных масштабах. Обычный человек не может просто пойти купить ASIC, подключить её и запустить. В то же самое время при майнинге с помощью процессора вы просто берёте процессор, подключаете его и запускаете процесс майнинга. При этом е требуется никакого специального напряжения, никакой специальной вентиляции, ничего такого.

И ещё один момент: люди не часто задумываются о правдоподобном отрицании. Если я покупаю ASIC и импортирую её из Китая, ASIC SHA-256, - совершенно очевидно в каких целях я её буду использовать. Начнутся вопросы: зачем вы это покупаете? У вас есть правительственная лицензия на использование этой схемы для майнинга на этом устройстве? Вы собираетесь заняться незаконной обработкой транзакций? Все всё будут знать. У любого, кто покупает ASIC, есть лишь одна причина для такой покупки. В случае с Monero, если вы покупаете кучу процессоров, может быть сотня причин, для чего вы это делаете. Ничего нельзя доказать. Нельзя даже предположить, что вы собираетесь использовать эти процессоры для майнинга Monero. Так что правдоподобное отрицание - это во всех отношениях, и не только в майнинге, очень важный момент, когда вы сталкиваетесь с государством.

Единообразие UTXO. Как уже говорилось, Bitcoin прозрачен, и UTXO можно различить между собой. С другой стороны, блокчейн Monero однороден - все UTXO выглядят одинаково. Взаимозаменяемость налицо. И мы ещё вернёмся к этому, когда перейдём к вопросу стимулирования комиссий.

И последнее - нарушение законов и правил. Когда вы занимаетесь майнингом, а узлы не готовы нарушать закон, они бесполезны, поскольку в любой момент государство может сказать: "Вас посадят, если поймают за майнингом Monero, запуском узла Monero или узла Bitcoin".

И в данном случае разница между белым и чёрным рынком очень важна, потому что любой участник белого рынка по определению будет придерживаться любых регулятивных норм и разрешений со стороны государства. Черный рынок по определению этого не требует. Там можно нарушать закон и делать всё, что заблагорассудится, поскольку это свободный рынок. Поэтому белый рынок всегда представляет собой угрозу с точки зрения безопасности. И я часто пишу об этом в Twitter. Покупать марихуану на белом рынке опасно, но на чёрном рынке продавец изначально готов идти против законов и правил, касающихся его деятельности на свободном рынке, и игнорировать их.

_[Реклама]_

_Вы любите кофе и Monero так же сильно, как и мы? А вам не хотелось бы начинать каждый свой день с чашки Gratuitas? Покупайте зёрна премиум-класса за Monero, и если вам придётся по душе их вкус, поделитесь цифровыми чаевыми напрямую с гватемальскими фермерами, которые позаботились о вас. Ваша поддержка способствует развитию нашего предприятия. Gratuitas и Monero._

_**Aeon:**_ А это небольшой мем, который я сделал его по этому поводу, и который, по-моему, очень хорошо отражает ситуацию. Здесь как бы подчёркивается, что майнеры на белом рынке представляют собой риск для безопасности, и именно майнеры белого рынка чаще всего создают гигантские фермы, которые легко идентифицировать, легко захватить и легко задействовать в своих целях.

Допустим, произошла атака 51%. Государству удалось захватить этот процент, и ему удалось произвести полноценную атаку 51%. Единственное решение в рамках системы доказательства работы, не требующей хардфорка, - давление со стороны рынка комиссий. И вот, допустим, государство контролирует 51% сети. Единственная защита сети, использующей механизм доказательства работы - достаточный размер комиссии за проведение цензурируемых транзакций, стимулирующий майнеров чёрного рынка повышать свой хэшрейт сети с целью получения комиссий, что позволит превзойти атакующего.

В случае Bitcoin это немного очевиднее, поскольку имеется прозрачный набор UTXO, и государство может цензурировать любые транзакции, которые ему не понравятся, равно как и пропускать определённые транзакции. Таким образом, давление со стороны комиссий за проведение таких цензурируемых транзакций должно достигнуть такого уровня, чтобы майнеры чёрного рынка или участники свободного рынка были экономически заинтересованы в увеличении хэшрейта сети и превышении хэшрейта лица, проводящего атаку 51%. Да, это не даёт никаких гарантий, но это единственный способ, позволяющий избежать хардфорка. И это имеет смысл, это экономически рационально.

Что касается алгоритма доказательства доли владения, то это также невозможно. В случае использования такого механизма сетью при получении 51% хэшрейта централизованным игроком, никак не получится превзойти его, поскольку он всегда будет получать большую долю, чем все остальные. Причина, по которой работает доказательство работы, заключается в том, что это метод внешнего подтверждения, позволяющий, по сути, добавить больше физической энергии в сеть. В случае с доказательством доли владения консенсус как бы встроен в сеть. Токен - это и есть консенсус, а консенсус опирается на токен. Поэтому метод доказательства доли владения, на мой взгляд, не имеет смысла в плане противодействия атакам 51%. В случае с сетью на базе такого доказательства нет способа иного способа справиться со злоумышленником, кроме как с помощью хардфорка. Доказательство работы позволяет добавлять энергию, превысить хэшрейт атакующего и собрать вознаграждения за проведение централизованных транзакций.

Методы с применением хардфорка меняют алгоритм хэширования, что пагубно сказывается на каждом майнере, а не только на злоумышленнике. Вся сеть как бы выжигается напалмом, и при этом уничтожается каждый майнер. Это не лучшее решение, а своего рода крайняя мера.

Изменение механизма консенсуса - то же самое. Страдают все легитимные майнеры, рациональные майнеры и майнеры чёрного рынка, а не только вредоносные майнеры.

Далее следует разрушение самой большой цепочки блоков. В случае Bitcoin - не думаю, что это возможно в случае Monero - но в случае Bitcoin есть команда RPC, позволяющая вручную признать определённый блок недействительным, даже если он таковым не является, после чего узел уже не будет далее следовать конкретной цепочке, поскольку будет считать блок недействительным. Даже если эта цепочка будет самой большой, в результате ручного вмешательства на таком блоке будет совершён форк, что, по сути, нарушит правила следования главной цепочке и доказательства работы, которые являются основополагающими с точки зрения консенсуса и координации системы.

Эти три метода не очень хороши. Опять же, что касается Monero, я смотрел, и не думаю, что в Monero есть команда для объявления блока недействительным. Так что, повторюсь, хардфорк - не лучший способ, но это своего рода крайняя мера. А желательно было бы использовать экономически рациональный метод.

Вот очень простой график, на создание которого меня вдохновил Эрик Воскуил, непревзойдённый исследователь в области существующих угроз, экономического стимулирования и прочих вещей, о которых говорится в одной из его книг, на которую я ссылаюсь в конце. Конкретно этот график основан на его презентации, которую я видел. Это основа модели безопасности для механизма доказательства работы. Когда Сатоши создал Bitcoin, он, по сути, создал свободный рынок в пространстве блоков. В этом пространстве майнеры продают подтверждения, а пользователи покупают место в данном пространстве, выплачивая комиссии за проведение транзакций. Это и есть свободный рынок. Майнеры продают место в пространстве блоков, пользователи покупают его. Всё очень просто. Именно на этом основана модель безопасности. Если майнеры продают место, но никто не хочет его покупать, сеть небезопасна. Никто не использует её. И наоборот. Если пользователи хотят купить место в пространстве блоков, а никто его не предлагает, модель безопасности также разрушается.

Есть несколько моментов, которые я считаю важными и с которыми некоторые могут не согласиться. Я не совсем согласен с тем, что постэмиссия Monero повышает уровень безопасности сети, особенно в случае проведения атаки 51%, потому что при проведении такой атаки злоумышленник в любом случае получит субсидию. Нет никакого способа предотвратить получение субсидии злоумышленником. Злоумышленник по умолчанию получает деньги за атаку на сеть, поскольку есть постэмиссия и субсидия. Кроме того, при проведении атаки 51%, злоумышленник выбирает, кто получит субсидию. И блок будет вычислен меньшинством майнеров, а большинство, контролирующее 51% хэшрейта не захочет, чтобы они получили субсидию, большинство просто проигнорирует такой блок, сделает его "осиротевшим" и построит свою собственную цепочку. Таким образом, злоумышленник, контролирующий 51% хэшрейта, сам выбирает, кому платить, а кому нет, и в этой ситуации он всегда будет получать субсидию. И в случае Bitcoin происходит то же самое.

И ещё один момент. Что касается набора выходов UTXO, в случае Bitcoin можно увидеть, что происходит. Этот набор прозрачен. В случае Monero - нет. В перспективе, при каких-то возможных обстоятельствах, обладая 51% хэшрейта, государство может потребовать от вас предоставить свои ключи просмотра вашей транзакции, чтобы обработать её и добавить в блок. В этом сценарии государство может заявить, что будет обрабатывать транзакции только в том случае, если в дополнительном поле транзакции будет указан ключ просмотра. И в этом случае мы снова возвращаемся к сценарию давления со стороны комиссий, когда государство не станет обрабатывать транзакции, к которым не прилагаются ключи просмотра. Но пока я не думаю, что это реально.

Опять же, Monero с её устойчивостью к использованию ASIC, более распределённым майнингом, отсутствием централизации этого процесса, прозрачным набором UTXO, прошу прощения, единообразным набором UTXO и полной анонимностью действительно имеет более высокий уровень защиты от атаки 51%.

У меня получилось всё рассказать довольно быстро, поэтому надеюсь, будет много вопросов. Да, вы можете связаться со мной в Twitter. Это книга, о которой я говорил. Я многое почерпнул из книги "Криптоэкономика" Эрика Воскуила, который, вероятно, является главным специалистом в области моделирования угроз. Если вы интересуетесь подобными вещами, вы обязательно должны прочитать её - настоятельно рекомендую. Этом можно сделать абсолютно бесплатно на GitHub и, по-моему, её версия в pdf также скачивается бесплатно. На этом у меня всё.

Если есть вопросы, буду рад на них ответить.

_**Модератор:**_ У меня есть вопрос. Ты - Сатоши Накамото?

_**Aeon:**_ Я бы никак не смог доказать это. Даже если бы у меня были ключи.

_**Модератор:**_ Хорошо.

_**Aeon:**_ Я мог бы их украсть.

_**Модератор:**_ Безусловно. Хорошо. Большое спасибо за выступление.

_**Aeon:**_ Спасибо.
